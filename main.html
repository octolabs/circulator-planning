<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>Circulator Planning Tool</title>
	<!--link href="/static/css/default.css" type="text/css" rel="stylesheet" /-->
	<script language="javascript" src="static/js/jquery-1.2.3.js"></script>
	<script language="javascript" src="static/js/json2.js"></script>
	<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
	<script type="text/javascript">
	  var map;
	  var markers = new Array();
	  var markersJS=new Array();

	  var routes = new Array();
	  var routesJS=new Array();

	  var state;
	  var loc;
		
	  function initialize() {
		state="new";
	  	
	    var latlng = new google.maps.LatLng(38.89545,-77.015871);
	    var myOptions = {
	      zoom: 12,
	      center: latlng,
	      mapTypeId: google.maps.MapTypeId.ROADMAP
	    };
	    map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

	    google.maps.event.addListener(map, 'click', function(event) {
	    	placeMarker(event.latLng);	
	  	});
	
		var ctaLayer = new google.maps.KmlLayer('http://circulator-planning.appspot.com/static/data/routes.kml');
	    ctaLayer.setMap(map);
	
	    //var ctaLayer2 = new google.maps.KmlLayer('http://gmaps-samples.googlecode.com/svn/trunk/ggeoxml/cta.kml');
	    //ctaLayer2.setMap(map);
	
	    //alert("kml layer set")
		

	  }
	

	
	function placeMarker(location) {
	  //alert("place marker");
	  var image="static/img/red_MarkerO.png";
	
	  //alert(state);
	
	  if (state=="new") {
		    image="static/img/red_MarkerO.png";
			state="in process";
   		   	loc=location;
		}
	  else {
		    image="static/img/red_MarkerD.png";
			state="new";
			
			var path = [loc,location];
		    var route = new google.maps.Polyline({
		      path: path,
		      strokeColor: "#FF0000",
		      strokeOpacity: 0.5,
		      strokeWeight: 10
		    });

		   route.setMap(map);
		
		  routes.push(route);
		  var routeJS={"origin_lat":loc.lat(), "origin_long":loc.lng(),"destination_lat":location.lat(), "destination_long":location.lng()};

		  routesJS.push(routesJS);

		}
		

	  //var clickedLocation = new google.maps.LatLng(location);
	  //var image = 'http://google-maps-icons.googlecode.com/files/cycling.png';
	  var marker = new google.maps.Marker({
	      position: location, 
	      map: map,
	      icon:image
	  });
	  
	  markers.push(marker);
	  var markerJS={"type":mode,"lat":location.lat(), "long":location.lng()};
	  
	  markersJS.push(markerJS);

	  //alert(JSON.stringify(markersJS));

	  //map.setCenter(location);
	}
	
	function resetMap(){
	 	for (m=0; m<markers.length; m++)
		{
			markers[m].setMap(null);
		}
		
		markers=new Array();
		markersJS= new Array();
	}
	
	function formSubmit(){
		document.cabisurvey.data.value=JSON.stringify(markersJS); 
		
		return true;
	}

	</script>
	
	
</head>
<body  onload="initialize()">
<center>
	<h1>This is just a beta, don't submit your responses, yet!</h1>
<table width="1000px">
	<tr>
		<td colspan="2" bgcolor="red">
			<img src="/static/img/circulator_logo.png"/><font face="Helvetica, Arial" size="48px" color="white"> &nbsp; <b>Planning Survey</b></font>
		</td>
	</tr>
	<tr>
		<td width="800" align="left">
			Welcome!  The goal of this survey is to engage the public to suggest expansion for DC Circulator bus system for next 1, 5, 10 years.
			<br/>
			<br/>
			We will conduct two surveys to collect feedback on general "corridors" that should be served by Circulator, and then detailed information
			about routes/bus stops in defined "corridors". This is survey #1, come back in couple of weeks for survey #2!
			<br/>
			<br/>
			<form id="cabisurvey" name="cabisurvey" method="POST" action="/survey">
			<input type="hidden" name="data" id="data"/>
			<div id="part1">
				<b>Step 1 - Define new "corridors" connecting locations in DC that should be served by Circulator</b> 
				<br/>
				Use map below to roughly define locations in DC that should be connected by future Circulator routes. It can be extensions to existing routes, or new locations not 		
				connected to the existing routes. 
				<br/>
				<center>
				<div id="map_canvas" style="width:750px; height:450px"></div>
				
				<!--<input type="radio" name="group0" id="group0" value="Yes" checked> Origin &nbsp;
				<input type="radio" name="group0" id="group0" value="No"> Destination &nbsp;  -->
				
				<input type="button" value="Reset map" onclick="javascript:resetMap();"/>
				
				</center>
				
			</div>
			<br/>
			<br/>

			<div id="part0">
				Please, explain in as much details as possible rationale for added locations/connections that you proposed:
				<textarea cols="100" rows="5" name="explanation"></textarea> <br/>
				<br/>
			</div>

			<br/>
			<br/>
			<div id="part2">
				<b>Step 2 - Rider's profile</b> 
				<br/>
				<br/>
				Do you ride Circulator?:
				<input type="radio" name="group1" value="Yes"> Yes &nbsp;
				<input type="radio" name="group1" value="No"> No <br/>
				<br/>
				How/when you ride Circulator?:
				<input type="checkbox" name="group2" value="Commute"> Daily commute to work &nbsp;
				<input type="checkbox" name="group2" value="Lunch"> Lunch &nbsp;
				<input type="checkbox" name="group2" value="Evening"> Evening outings &nbsp;
				<input type="checkbox" name="group2" value="Weekends"> Weekends &nbsp;
				<input type="checkbox" name="group2" value="Other"> Other &nbsp;<br/>
				
				
			</div>

			<br/>
			<br/>
			<div id="part3">
				<b>Step 3 - Sign up for updates</b> (optional)
				<br/>
				<br/>
				Your email address: <input type="text" size="75" name="email" value=""/>
				
			</div>
			<br/>
			<br/>
			<input type="submit" value="Submit!" onclick="javascript:formSubmit();">
			</form>
			
			
		</td>
		<td width="200" valign="top">
			<script src="http://widgets.twimg.com/j/2/widget.js"></script>
			<script>
			new TWTR.Widget({
			  version: 2,
			  type: 'search',
			  search: 'DCCirculator',
			  interval: 6000,
			  title: 'Twitter Stream',
			  subject: 'DC Circulator',
			  width: 250,
			  height: 300,
			  theme: {
			    shell: {
			      background: '#8ec1da',
			      color: '#ffffff'
			    },
			    tweets: {
			      background: '#ffffff',
			      color: '#444444',
			      links: '#1985b5'
			    }
			  },
			  features: {
			    scrollbar: false,
			    loop: true,
			    live: true,
			    hashtags: true,
			    timestamp: true,
			    avatars: true,
			    toptweets: true,
			    behavior: 'default'
			  }
			}).render().start();
			</script>
		</td>
	</tr>
	<tr>
		<td colspan="2">
			Learn more about <a href="http://dccirculator.com">DC Circulator</a>.
		</td>
	</tr>
</table>
</center>

{% block body %}{% endblock %}

</body>





